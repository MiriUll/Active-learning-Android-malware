# Basic idea: yield window for each apk or return info for next apk
from networkx import ego_graph


class Window_Generator:

    def __init__(self, feature_generator):
        self.feature_generator = feature_generator

    def next_training_data(self, apps):
        print('************************\nGenerating features for subgraphs')
        for app in apps:
            try:
                entry = next(app.entrypoints)
                subgraph = ego_graph(app.graph, entry, radius=3)
                yield self.feature_generator.generate_features(subgraph), app.label
            except StopIteration:
                yield None
