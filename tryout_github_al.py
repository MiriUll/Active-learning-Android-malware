from utils.utils import *
import numpy as np
from config import *
# from utils.alp.active_learning.active_learning import ActiveLearner
from utils.alp.active_learning import ActiveLearner
from sklearn.linear_model import LogisticRegression
from sklearn.naive_bayes import GaussianNB

# malware_dir = '/home/anschutzm/PycharmProjects/malewaredetection/utils/source_codes/s.home.anschutzm.Dokumente.TUM.WS1718.AndroidSecurity.Exercise9.malicia_ex9.MalGenome.malware./'
# goodware_dir = '/home/anschutzm/PycharmProjects/malewaredetection/utils/source_codes/s.home.anschutzm.Dokumente.TUM.WS1718.AndroidSecurity.Exercise9.malicia_ex9.MalGenome.goodware./'
percentage_test = 0.1
percentage_unlabeled = 0.6


def davernig():
    training_data, test_data, y_train, y_test = load_datasets(malware_features, goodware_features, percentage_test)

    training_label, training_unlabeld, y_label, y_oracle = split_dataset(training_data, y_train, percentage_unlabeled)
    print(len(training_data), len(training_unlabeld))

    clf = LogisticRegression().fit(training_label, y_label)
    nb = GaussianNB().fit(training_label, y_label)

    AL = ActiveLearner(strategy='entropy')
    ranking = AL.rank(clf, np.asarray(training_unlabeld), num_queries=0.8)
    ranking.sort(reverse=True)
    print(ranking)

    '''AL = ActiveLearner(strategy='least_confident')
    ranking = AL.rank(clf, training_unlabeld, num_queries=3)
    print(ranking)

    AL = ActiveLearner(strategy='average_kl_divergence')
    ranking = AL.rank([clf, nb], training_unlabeld, num_queries=3)
    print(ranking)'''

    for index in ranking:
        training_label.append(training_unlabeld[index])
        y_label.append(y_oracle[index])


if __name__ == '__main__':
    davernig()
